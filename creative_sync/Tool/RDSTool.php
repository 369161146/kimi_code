<?php
require '../Lib/syncInit.php';
use Lib\Core\SyncConf;
use Api\CommonSyncApi;
use Helper\NoticeSyncHelper;
use Helper\CommonSyncHelper;
use Lib\Core\SyncDB;
class RDSTool extends SyncDB{

	public function __construct(){	    
		$this->dbObj = $this->getDB();
		
	}
	
	public function run(){    
        $this->runRds();
	}
	
	public function runRds(){
		$camIdList = "135973476,135615668,134690411,134603741,134268768,134268767,134258160,134217074,134088012,133949883,133949882,133937520,133838512,133835225,133783406,133503303,133478113,133453427,133135162,133121670,133121665,133121011,133121007,133121006,133027267,132804052,132770174,132404761,131785253,131688862,130562927,130340999,130119971,130108266,129935973,129905675,129866049,129680372,129647258,129637179,129108637,129107239,129107238,128922570,128850236,128564857,128495349,126849039,126601717,126601716,126193883,126193876,125915584,124286432,123256416,123223034,123223019,123223005,123222999,122570702,122570037,121759324,121759323,121313428,121313426,121220211,121038974,120291657,120291649,119768107,119768104,119405649,119284142,118407162,118291105,117876741,116337889,116334041,116016896,115415883,115049066,115049065,115039786,115038630,115038591,114783827,114753736,114736247,114516846,114184843,114175739,114175736,114175733,114172983,114170924,114170919,114140784,114140284,114067666,113952556,113651464,113651463,113651462,113650638,113650636,113650357,112679559,112676690,112657851,112156181,112141347,112140968,112087263,111947017,111896793,111725302,111648376,111543750,111543744,111539505,111481518,110648251,110648249,110635530,110247502,110174648,110172052,109881256,109700396,109615740,109295130,109210197,109209620,109207907,109136489,109022648,107872383,107872382,107750708,107265193,107260852,107260845,107252874,107068835,106550286,106526823,106513875,106028444,105859948,105772879,105772876,105243232,104844099,103796190,103256670,101711562,101459739,101452072,101220182,100975761,100165778,100165428,96762394,95578844,95472064,95005707,94365507,93800203,90738347,90252814,85363013,83432146,71336299,64511914,59554424,56157855,51556806,43449147,43301940,39038076,17175606,
	    		4163438,2244002,2208923,1946818,1757832,1011047,624096,523448,296053,295881,295451,96832,63685,3015,3000,2996,654,652,586";
	    $sqlStr = 'SELECT campaign_id,image,type from creative_list where campaign_id in('.$camIdList.') and type = 94';
	    $rz = $this->newQuery($sqlStr);
	    $this->handelResult($rz,$camIdList);
	}
	
	public function handelResult($rz,$camIdList){
		$camIdListArr = explode(",", $camIdList);
		if(empty($camIdListArr)){
			return false;
		}
		if(empty($rz)){
			return false;
		}
		$newRz = array();
		foreach ($rz as $k => $v){
			$newRz[$v['campaign_id']] = $v;
		}
		foreach ($camIdListArr as $k => $v_id){
			$v_id = trim($v_id);
			if(empty($newRz[$v_id])){
				echo $v_id."\t"."\t".PHP_EOL;
			}else{
				echo $v_id."\t".$newRz[$v_id]['image']."\t".$newRz[$v_id]['type'].PHP_EOL;
			}
		}
	}
}

ini_set('memory_limit','1024M');
error_reporting(E_ERROR | E_WARNING | E_PARSE);
ini_set('display_errors', 1);
define('SYNC_OFFER_DEBUG',0);
define('SYNC_OFFER_TMP_FILE_PATH',ROOT_DEV_DIR.'/upload_files/tmp_files/');
define('SCRIPT_BEGIN_TIME',CommonSyncHelper::microtime_float());
$obj = new RDSTool();
$obj->run();
